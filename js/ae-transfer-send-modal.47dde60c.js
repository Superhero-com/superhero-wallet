"use strict";(self["webpackChunksuperhero_wallet"]=self["webpackChunksuperhero_wallet"]||[]).push([[641],{50052:(e,t,n)=>{n.r(t),n.d(t,{default:()=>xe});var a=n(66252);function r(e,t,n,r,s,o){var i=(0,a.up)("TransferSendBase");return(0,a.wg)(),(0,a.j4)(i,(0,a.dG)(e.$attrs,{protocol:e.PROTOCOL_AETERNITY,"current-step":e.currentStep,"edit-transfer":e.editTransfer,"proceed-to-next-step":e.proceedToNextStep,"hide-arrow-send-icon":e.isMultisig,"custom-primary-button-text":e.customPrimaryButtonText,"primary-button-disabled":e.isPrimaryButtonDisabled,onClose:e.resolve}),{content:(0,a.w5)((function(){return[((0,a.wg)(),(0,a.j4)((0,a.LL)(e.currentStepConfig.component),{ref:"currentRenderedComponent",transferData:e.transferData,"onUpdate:transferData":t[0]||(t[0]=function(t){return e.transferData=t}),"is-multisig":e.isMultisig,"is-address-chain":e.isAddressChain,"is-address-url":e.isAddressUrl,onSuccess:e.currentStepConfig.onSuccess,onError:t[1]||(t[1]=function(t){return e.error=t})},null,40,["transferData","is-multisig","is-address-chain","is-address-url","onSuccess"]))]})),_:1},16,["protocol","current-step","edit-transfer","proceed-to-next-step","hide-arrow-send-icon","custom-primary-button-text","primary-button-disabled","onClose"])}var s=n(62118),o=(n(27852),n(2262)),i=n(79150),l=n(33907),u=n(32720),c=n(79323),d=n(48854),p=n(16982),m=n(28243),v=n(37335),f=(n(56977),n(96647),n(83710),n(41539),n(39714),n(3577)),g={class:"multisig-addresses-row"},A={key:0,class:"payload-add-wrapper"},T={class:"payload-options"};function h(e,t,n,r,s,o){var i=(0,a.up)("ModalHeader"),l=(0,a.up)("InfoBox"),u=(0,a.up)("FormSelect"),c=(0,a.up)("AccountItem"),d=(0,a.up)("DetailsItem"),p=(0,a.up)("TransferSendRecipient"),m=(0,a.up)("BtnPlain"),v=(0,a.up)("TransferSendAmount"),h=(0,a.up)("BtnText"),w=(0,a.up)("BtnHelp"),x=(0,a.up)("BtnIcon"),b=(0,a.up)("PayloadDetails"),k=(0,a.up)("TransferSendFormBase");return(0,a.wg)(),(0,a.j4)(k,(0,a.dG)(e.$attrs,{"transfer-data":e.transferData,fee:+e.fee.toFixed(),"fee-symbol":e.AE_SYMBOL,protocol:e.PROTOCOL_AETERNITY,class:"transfer-send-form"}),(0,a.Nv)({recipient:(0,a.w5)((function(){return[(0,a.Wm)(p,{modelValue:e.formModel.address,"onUpdate:modelValue":t[1]||(t[1]=function(t){return e.formModel.address=t}),modelModifiers:{trim:!0},errors:e.errors,"is-tip-url":e.isTipUrl,protocol:e.PROTOCOL_AETERNITY,placeholder:e.isUrlTippingEnabled?e.$t("modals.send.recipientPlaceholderUrl"):e.$t("modals.send.recipientPlaceholder"),"validation-rules":Object.assign(Object.assign({name_registered_address_or_url:e.isUrlTippingEnabled,name_registered_address:!e.isUrlTippingEnabled},e.isMultisig?{not_same_as:e.multisigVaultAddress}:{}),{token_to_an_address:[!e.isAe]}),onOpenQrModal:e.openScanQrModal},null,8,["modelValue","errors","is-tip-url","protocol","placeholder","validation-rules","onOpenQrModal"])]})),amount:(0,a.w5)((function(){var n;return[(0,a.Wm)(v,{modelValue:e.formModel.amount,"onUpdate:modelValue":t[2]||(t[2]=function(t){return e.formModel.amount=t}),"custom-label":e.isMultisig?e.$t("modals.multisigTxProposal.amount"):"",errors:e.errors,"selected-asset":e.formModel.selectedAsset,readonly:e.isMultisig,protocol:e.PROTOCOL_AETERNITY,"validation-rules":Object.assign(Object.assign(Object.assign(Object.assign({},+e.balance.minus(e.fee)>0&&!e.isMultisig?{max_value:e.max}:{}),e.isMultisig?{enough_ae_signer:e.fee.toString()}:{enough_coin:e.fee.toString()}),+e.balance.minus(e.fee)>0&&e.isMultisig?{max_value_vault:null===(n=e.activeMultisigAccount)||void 0===n?void 0:n.balance.toString()}:{}),{ae_min_tip_amount:e.isTipUrl}),onAssetSelected:e.handleAssetChange},{"label-after":(0,a.w5)((function(){return[e.isMultisig?(0,a.kq)("",!0):((0,a.wg)(),(0,a.j4)(m,{key:0,class:(0,f.C_)(["max-button",{chosen:e.isMaxValue}]),onClick:e.setMaxValue},{default:(0,a.w5)((function(){return[(0,a.Uk)((0,f.zw)(e.$t("common.max")),1)]})),_:1},8,["class","onClick"]))]})),_:1},8,["modelValue","custom-label","errors","selected-asset","readonly","protocol","validation-rules","onAssetSelected"])]})),_:2},[e.isMultisig?{name:"header",fn:(0,a.w5)((function(){return[(0,a.Wm)(i,{title:e.$t("modals.multisigTxProposal.title")},null,8,["title"]),e.hasMultisigTokenWarning?((0,a.wg)(),(0,a.j4)(l,{key:0,type:e.INFO_BOX_TYPES.warning,text:e.$t("modals.multisigTxProposal.tokenWarning")},null,8,["type","text"])):(0,a.kq)("",!0),(0,a._)("div",g,[(0,a.Wm)(d,{class:"multisig-address-item"},{label:(0,a.w5)((function(){return[e.multisigVaultOwnedByManyAccounts?((0,a.wg)(),(0,a.j4)(u,{key:0,options:e.accountsAllowedToProposeTxSelectOptions,"default-text":e.$t("modals.multisigTxProposal.signingAccount"),value:e.activeAccount.address,class:"account-selector","persistent-default-text":"",unstyled:"","account-select":"",onSelect:t[0]||(t[0]=function(t){return e.selectAccount(t)})},null,8,["options","default-text","value"])):((0,a.wg)(),(0,a.iD)(a.HY,{key:1},[(0,a.Uk)((0,f.zw)(e.$t("modals.multisigTxProposal.signingAccount")),1)],64))]})),value:(0,a.w5)((function(){return[(0,a.Wm)(c,{address:e.activeAccount.address,protocol:e.activeAccount.protocol},null,8,["address","protocol"])]})),_:1}),(0,a.Wm)(d,{class:"multisig-address-item",label:e.$t("modals.multisigTxProposal.multisigVault")},{value:(0,a.w5)((function(){return[(0,a.Wm)(c,{address:e.multisigVaultAddress,protocol:e.PROTOCOL_AETERNITY},null,8,["address","protocol"])]})),_:1},8,["label"])])]})),key:"0"}:void 0,e.isAe?{name:"extra",fn:(0,a.w5)((function(){return[e.formModel.payload&&e.formModel.payload.length?((0,a.wg)(),(0,a.j4)(b,{key:1,payload:e.formModel.payload,class:"payload-details"},{default:(0,a.w5)((function(){return[(0,a._)("div",T,[(0,a.Wm)(x,{size:"sm",dimmed:"",icon:e.EditIcon,onClick:e.editPayload},null,8,["icon","onClick"]),(0,a.Wm)(x,{size:"sm","icon-variant":"danger",dimmed:"",icon:e.DeleteIcon,onClick:e.clearPayload},null,8,["icon","onClick"])])]})),_:1},8,["payload"])):((0,a.wg)(),(0,a.iD)("div",A,[(0,a.Wm)(h,{icon:e.PlusCircleIcon,text:e.$t("modals.send.payload"),onClick:e.editPayload},null,8,["icon","text","onClick"]),(0,a.Wm)(w,{title:e.$t("modals.payloadInfo.title"),msg:e.$t("modals.payloadInfo.msg")},null,8,["title","msg"])]))]})),key:"1"}:void 0]),1040,["transfer-data","fee","fee-symbol","protocol"])}n(35666),n(26699),n(32023),n(57327),n(32564);var w=n(22201),x=n(71584),b=n(2114),k=n(34601),y=n(89234),O=n(14918),_=n(43365),I=n(82399),M=n(43647),C=n(46483),R=n(95951),D=n(23432),E=n(91103),S=n(37896),P=n(63530),N=n(866),B=n(51877),Z=n(36172),L=n(82414),F=n(50033),W=function(e,t,n,a){function r(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,s){function o(e){try{l(a.next(e))}catch(t){s(t)}}function i(e){try{l(a["throw"](e))}catch(t){s(t)}}function l(e){e.done?n(e.value):r(e.value).then(o,i)}l((a=a.apply(e,t||[])).next())}))};const Y=(0,a.aZ)({name:"AeTransferSendForm",components:{BtnPlain:N.Z,TransferSendAmount:B.Z,TransferSendRecipient:P.Z,DetailsItem:R.Z,BtnIcon:D.Z,PayloadDetails:E.Z,BtnHelp:S.Z,BtnText:C.Z,TransferSendFormBase:y.Z,InfoBox:M.Z,ModalHeader:O.Z,AccountItem:_.Z,FormSelect:I.Z},model:{prop:"transferData"},props:{transferData:{type:Object,required:!0},isMultisig:Boolean},emits:["update:transferData","success","error"],setup:function(e,t){var n=t.emit,r=(0,l.oR)(),s=(0,w.yj)(),i=(0,o.iH)(!1),v=(0,o.iH)(!1),f=(0,o.iH)(null),g=(0,p.ol)(),A=g.openModal,T=(0,p.Bo)({store:r}),h=T.activeMultisigAccount,y=(0,p.ln)({store:r}),O=y.balance,_=(0,p.jg)({store:r}),I=_.marketData,C=(0,p.xe)({store:r}),R=C.accounts,D=C.activeAccount,E=C.setActiveAccountByGlobalIdx,S=C.setActiveAccountByAddress,P=C.prepareAccountSelectOptions,N=(0,u.eJ)("fungibleTokens"),B=(0,a.Fl)((function(){return N.value.availableTokens}));function Y(t,n){var a=x.l.getAdapter(c.DJ).getDefaultCoin(I.value,+O.value);return t?e.isMultisig&&![m.WJ,m.ik].includes(t)?void(i.value=!0):(i.value=!1,B.value[t]||a):n?void 0:a}var $=(0,b.A)({transferData:e.transferData,getSelectedAssetValue:Y,protocol:c.DJ}),V=$.formModel,j=$.errors,U=$.hasError,z=$.invoiceId,H=$.invoiceContract,q=$.clearPayload,J=$.handleAssetChange,G=$.updateFormModelValues,Q=$.openScanQrModal,X=(0,p.Wp)({formModel:V,store:r}),K=X.max,ee=X.fee,te=(0,a.Fl)((function(){var e;return null===(e=h.value)||void 0===e?void 0:e.gaAccountId})),ne=(0,a.Fl)((function(){var e;return(null===(e=V.value.selectedAsset)||void 0===e?void 0:e.contractId)===m.ik})),ae=(0,a.Fl)((function(){return N.value.tokenBalances})),re=(0,a.Fl)((function(){return!!V.value.address&&v.value&&(0,d.pM)(V.value.address)&&!(0,k.qi)(V.value.address)})),se=(0,a.Fl)((function(){var e,t=+((null===(e=V.value)||void 0===e?void 0:e.amount)||0);return t>0&&t===+K.value})),oe=R.value.filter((function(e){var t,n=e.address;return null===(t=h.value)||void 0===t?void 0:t.signers.includes(n)})),ie=(0,a.Fl)((function(){return(null===oe||void 0===oe?void 0:oe.length)>1})),le=(0,a.Fl)((function(){return P(oe)}));function ue(){A(c.L1,{payload:V.value.payload}).then((function(e){V.value.payload=e}))["catch"]((function(){return null}))}function ce(e){e&&(S(e),V.value.amount&&f.value&&f.value.validate())}function de(){var e=ee.value;V.value.amount=K.value,setTimeout((function(){e!==ee.value&&(V.value.amount=K.value)}),100)}function pe(){var e,t=Object.assign(Object.assign({},V.value),{fee:ee.value,total:(ne.value?+ee.value.toFixed():0)+ +((null===(e=V.value)||void 0===e?void 0:e.amount)||0),invoiceId:z.value,invoiceContract:H.value});return n("update:transferData",t),(0,a.Y3)()}function me(){return W(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(U.value){e.next=4;break}return e.next=3,pe();case 3:n("success");case 4:case"end":return e.stop()}}),e)})))}return(0,a.YP)(U,(function(e){return n("error",e)}),{deep:!0}),(0,a.YP)(V,(function(){pe()}),{deep:!0}),(0,a.YP)(D,(function(){var t,n,a;e.isMultisig&&!(null===(t=h.value)||void 0===t?void 0:t.signers.includes(D.value.address))&&E(oe[0].globalIdx);var r=s.query;(0,d.bO)(r)&&(v.value=!0),G(Object.assign(Object.assign({},r),{token:r.token||(null===(a=null===(n=V.value)||void 0===n?void 0:n.selectedAsset)||void 0===a?void 0:a.contractId)}))}),{deep:!0,immediate:!0}),{INFO_BOX_TYPES:M._,AE_SYMBOL:m.WJ,PROTOCOL_AETERNITY:c.DJ,isAe:ne,hasMultisigTokenWarning:i,multisigVaultAddress:te,activeMultisigAccount:h,multisigVaultOwnedByManyAccounts:ie,accountsAllowedToProposeTxSelectOptions:le,formModel:V,isUrlTippingEnabled:v,fee:ee,max:K,errors:j,balance:O,isTipUrl:re,isMaxValue:se,activeAccount:D,editPayload:ue,clearPayload:q,openScanQrModal:function(){return Q(ae.value)},handleAssetChange:J,selectAccount:ce,setMaxValue:de,submit:me,EditIcon:Z.Z,DeleteIcon:L.Z,PlusCircleIcon:F.Z}}});var $=n(83744);const V=(0,$.Z)(Y,[["render",h],["__scopeId","data-v-4265d770"]]),j=V;n(68309);var U={class:"review-tip-wrapper"},z={class:"account-info"},H={class:"name-address-wrapper"},q={key:1},J={class:"token-amount-wrapper"},G={class:"lowercase"},Q={class:"tip-url"},X={class:"subtitle"};function K(e,t,n,r,s,o){var i=(0,a.up)("LinkButton"),l=(0,a.up)("i18n-t"),u=(0,a.up)("ModalHeader"),c=(0,a.up)("Avatar"),d=(0,a.up)("Truncate"),p=(0,a.up)("AddressTruncated"),m=(0,a.up)("TokenAmount"),v=(0,a.up)("FormTextarea");return(0,a.wg)(),(0,a.iD)("div",U,[(0,a.Wm)(u,{title:e.$t("pages.send.sendingCryptoToUrl")},{subtitle:(0,a.w5)((function(){return[(0,a.Wm)(l,{keypath:"pages.send.tipInfo",tag:"span",class:"subtitle",scope:"global"},{default:(0,a.w5)((function(){return[(0,a.Wm)(i,{href:s.AGGREGATOR_URL,class:"link"},{default:(0,a.w5)((function(){return[(0,a.Uk)((0,f.zw)(e.$t("pages.notifications.superhero")),1)]})),_:1},8,["href"])]})),_:1})]})),_:1},8,["title"]),(0,a._)("div",z,[(0,a.Wm)(c,{address:r.activeAccount.address,size:"lg"},null,8,["address"]),(0,a._)("div",H,[r.activeAccount.name?((0,a.wg)(),(0,a.j4)(d,{key:0,str:r.activeAccount.name},null,8,["str"])):((0,a.wg)(),(0,a.iD)("div",q,(0,f.zw)(o.getDefaultAccountLabel({protocolIdx:r.activeAccount.idx})),1)),(0,a.Wm)(p,{"show-explorer-link":"",address:r.activeAccount.address,protocol:s.PROTOCOL_AETERNITY},null,8,["address","protocol"])])]),(0,a._)("span",J,[(0,a.Uk)((0,f.zw)(e.$t("pages.send.sending"))+" ",1),(0,a.Wm)(m,{amount:+n.transferData.amount,symbol:o.tokenSymbol,"hide-fiat":o.isAex9,protocol:s.PROTOCOL_AETERNITY,"data-cy":"review-total"},null,8,["amount","symbol","hide-fiat","protocol"]),(0,a._)("span",G,(0,f.zw)(e.$t("pages.send.to")),1)]),(0,a._)("div",Q,(0,f.zw)(n.transferData.address),1),(0,a.Wm)(v,{modelValue:s.note,"onUpdate:modelValue":t[0]||(t[0]=function(e){return s.note=e}),size:"sm",label:e.$t("pages.send.messageUrlOwner"),message:o.noteError},{"label-after":(0,a.w5)((function(){return[(0,a._)("span",{class:(0,f.C_)(["counter",{"below-zero":o.charactersLeft<0}])},(0,f.zw)(o.charactersLeft),3)]})),_:1},8,["modelValue","label","message"]),(0,a._)("span",X,(0,f.zw)(e.$t("pages.tipPage.claimingExplanation")),1)])}var ee=n(11538),te=n(10883),ne=n(15990),ae=n(22572),re=n(78210),se=n(52203),oe=n(73281);const ie={name:"TransferReviewTip",components:{AddressTruncated:oe.Z,LinkButton:te.Z,ModalHeader:O.Z,TokenAmount:ne.Z,FormTextarea:ae.Z,Avatar:re.Z,Truncate:se.Z},model:{prop:"transferData"},props:{transferData:{type:Object,required:!0}},setup:function(){var e=(0,l.oR)(),t=(0,p.xe)({store:e}),n=t.activeAccount;return{activeAccount:n}},data:function(){return{AGGREGATOR_URL:c.IE,AE_CONTRACT_ID:m.ik,PROTOCOL_AETERNITY:c.DJ,note:"",noteMaxLength:280}},computed:{isAex9:function(){var e,t;return(null===(e=this.transferData)||void 0===e||null===(t=e.selectedAsset)||void 0===t?void 0:t.contractId)!==m.ik},noteError:function(){return this.note.length>this.noteMaxLength?this.$t("pages.tipPage.maxNoteLengthError"):null},charactersLeft:function(){return this.noteMaxLength-this.note.length},tokenSymbol:function(){var e;return(null===(e=this.transferData.selectedAsset)||void 0===e?void 0:e.symbol)||"-"}},watch:{noteError:function(e){this.$emit("error",!!e)},note:function(e){this.$emit("input",(0,ee.Z)((0,ee.Z)({},this.transferData),{},{note:e}))}},methods:{getDefaultAccountLabel:d.gg,submit:function(){this.noteError||this.$emit("success")}}},le=(0,$.Z)(ie,[["render",K],["__scopeId","data-v-458b7222"]]),ue=le;var ce={key:0,class:"multisig-account"};function de(e,t,n,r,s,o){var i=(0,a.up)("AccountItem"),l=(0,a.up)("DetailsItem"),u=(0,a.up)("TokenAmount"),c=(0,a.up)("TransferReviewBase");return(0,a.wg)(),(0,a.j4)(c,{title:e.isMultisig?e.$t("modals.multisigTxProposal.title"):void 0,"without-subtitle":e.isMultisig,"sender-label":e.isMultisig?e.$t("modals.multisigTxProposal.signingAddress"):void 0,"base-token-symbol":e.AE_SYMBOL,"transfer-data":e.transferData,loading:e.loading,"avatar-name":e.isAddressChain?e.transferData.address:void 0,"show-fiat":e.isSelectedAssetAex9,protocol:e.PROTOCOL_AETERNITY,class:"transfer-review"},(0,a.Nv)({subheader:(0,a.w5)((function(){return[e.isMultisig?((0,a.wg)(),(0,a.iD)("div",ce,[(0,a.Wm)(i,{address:e.activeMultisigAccount.gaAccountId,protocol:e.PROTOCOL_AETERNITY},null,8,["address","protocol"])])):(0,a.kq)("",!0)]})),"additional-fee":(0,a.w5)((function(){return[e.isMultisig?((0,a.wg)(),(0,a.j4)(l,{key:0,class:"details-item",label:e.$t("modals.multisigTxProposal.fee")},{value:(0,a.w5)((function(){return[(0,a.Wm)(u,{amount:e.PROPOSE_TRANSACTION_FEE,symbol:e.AE_SYMBOL,protocol:e.PROTOCOL_AETERNITY,"hide-fiat":"","high-precision":"","data-cy":"multisig-review-fee"},null,8,["amount","symbol","protocol"])]})),_:1},8,["label"])):(0,a.kq)("",!0)]})),total:(0,a.w5)((function(){return[e.transferData.selectedAsset.contractId===e.AE_CONTRACT_ID?((0,a.wg)(),(0,a.j4)(l,{key:0,label:e.$t("common.total"),class:"details-item"},{value:(0,a.w5)((function(){return[(0,a.Wm)(u,{amount:+e.transferData.total,symbol:e.AE_SYMBOL,protocol:e.PROTOCOL_AETERNITY,"high-precision":"","data-cy":"review-total"},null,8,["amount","symbol","protocol"])]})),_:1},8,["label"])):(0,a.kq)("",!0)]})),_:2},[e.isAddressUrl?{name:"recipient",fn:(0,a.w5)((function(){return[(0,a.Wm)(l,{"data-cy":"review-tip-url",class:"tip-url details-item",label:e.$t("pages.send.receivingUrl"),value:e.transferData.address},null,8,["label","value"])]})),key:"0"}:void 0]),1032,["title","without-subtitle","sender-label","base-token-symbol","transfer-data","loading","avatar-name","show-fiat","protocol"])}n(9653);var pe=n(65986),me=n(94308),ve=n(12120),fe=function(e,t,n,a){function r(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,s){function o(e){try{l(a.next(e))}catch(t){s(t)}}function i(e){try{l(a["throw"](e))}catch(t){s(t)}}function l(e){e.done?n(e.value):r(e.value).then(o,i)}l((a=a.apply(e,t||[])).next())}))};const ge=(0,a.aZ)({name:"AeTransferReview",components:{TokenAmount:ne.Z,DetailsItem:R.Z,TransferReviewBase:ve.Z,AccountItem:_.Z},model:{prop:"transferData"},props:{transferData:{type:Object,required:!0},recipientAddress:{type:String,default:null},amount:{type:Number,default:null},isMultisig:Boolean,isAddressChain:Boolean,isAddressUrl:Boolean},setup:function(e,t){var n=t.emit,r=(0,l.oR)(),s=(0,w.tv)(),u=(0,i.QT)(),v=u.t,f=(0,p.bl)(),g=f.homeRouteName,A=(0,p.ol)(),T=A.openDefaultModal,h=(0,p.TW)({router:s}),b=h.openCallbackOrGoHome,y=(0,p.DQ)({store:r}),O=y.upsertCustomPendingTransactionForAccount,_=(0,p.xe)({store:r}),I=_.activeAccount,M=(0,p.Bo)({store:r}),C=M.activeMultisigAccount,R=M.addTransactionToPendingMultisigAccount,D=M.updateMultisigAccounts,E=(0,p.YA)({store:r}),S=E.getTippingContracts,P=(0,o.iH)(!1),N=18294e-8,B=(0,a.Fl)((function(){var t,n;return(null===(n=null===(t=e.transferData)||void 0===t?void 0:t.selectedAsset)||void 0===n?void 0:n.contractId)!==m.ik}));function Z(){T({title:v("modals.transaction-failed.msg"),icon:"critical"})}function L(t){var a=t.amount,s=t.recipient,o=t.selectedAsset;return fe(this,void 0,void 0,regeneratorRuntime.mark((function t(){var i,l,u,d,p;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(i=o.contractId===m.ik,P.value=!0,t.prev=2,null===e.transferData.invoiceId){t.next=9;break}return t.next=6,r.dispatch("fungibleTokens/burnTriggerPoS",[o.contractId,a,e.transferData.invoiceContract,e.transferData.invoiceId,{waitMined:!1,modal:!1}]);case 6:l=t.sent,t.next=19;break;case 9:if(i){t.next=15;break}return t.next=12,r.dispatch("fungibleTokens/transfer",[o.contractId,s,a,{waitMined:!1,modal:!1}]);case 12:l=t.sent,t.next=19;break;case 15:return u=x.l.getAdapter(c.DJ),t.next=18,u.spend(a,s,{payload:e.transferData.payload});case 18:l=t.sent;case 19:return l&&!i?(d={hash:l.hash,pendingTokenTx:!0,pending:!0,transactionOwner:I.value.address,tx:{amount:a,callerId:I.value.address,contractId:o.contractId,type:pe.Vp[pe.Vp.ContractCallTx],function:m.ls.transfer,recipientId:s,arguments:[],fee:0}},O(I.value.address,d)):l&&(p={hash:l.hash,pending:!0,transactionOwner:I.value.address,tx:{amount:a,callerId:I.value.address,contractId:o.contractId,senderId:I.value.address,recipientId:s,type:pe.Vp[pe.Vp.SpendTx],function:m.ls.transfer,arguments:[],fee:0}},O(I.value.address,p)),n("success"),t.abrupt("return",l.hash);case 24:throw t.prev=24,t.t0=t["catch"](2),Z(),t.t0;case 28:return t.prev=28,P.value=!1,t.finish(28);case 31:case"end":return t.stop()}}),t,null,[[2,24,28,31]])})))}function F(t){var a=t.amount,s=t.recipient,o=t.selectedAsset,i=t.note;return fe(this,void 0,void 0,regeneratorRuntime.mark((function t(){var l,u,c,p,v,f;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return P.value=!0,t.prev=1,l=null,t.next=5,S();case 5:if(u=t.sent,c=u.tippingV1,p=u.tippingV2,v=p||c,o.contractId===m.ik||!p){t.next=17;break}return t.next=12,r.dispatch("fungibleTokens/createOrChangeAllowance",[o.contractId,e.amount]);case 12:return t.next=14,p.tip_token(s,(0,d.SC)(i),o.contractId,a);case 14:l=t.sent,t.next=20;break;case 17:return t.next=19,v.tip(s,(0,d.SC)(i),Object.assign({amount:a,waitMined:!1},{modal:!1}));case 19:l=t.sent;case 20:f={hash:l.hash,pending:!0,tipUrl:s,transactionOwner:I.value.address,tx:{amount:a,callerId:I.value.address,contractId:v.$options.address,type:pe.Vp[pe.Vp.ContractCallTx],function:"tip",selectedTokenContractId:o.contractId,arguments:[],fee:0}},O(I.value.address,f),b(!0),n("success"),t.next=32;break;case 26:throw t.prev=26,t.t0=t["catch"](1),b(!1),Z(),t.t0.payload={url:s},t.t0;case 32:return t.prev=32,P.value=!1,t.finish(32);case 35:case"end":return t.stop()}}),t,null,[[1,26,32,35]])})))}function W(){return fe(this,void 0,void 0,regeneratorRuntime.mark((function t(){var a,o,i,l,u,c;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(P.value=!0,t.prev=1,a=(0,p.RS)({store:r}),o=a.buildSpendTx,i=a.proposeTx,l=a.postSpendTx,!C.value){t.next=16;break}return t.next=6,o(C.value.gaAccountId,e.transferData.address,(0,k.Ze)(e.transferData.amount),e.transferData.payload||void 0);case 6:return u=t.sent,t.next=9,i(u,C.value.contractId);case 9:return c=t.sent,C.value.pending&&R(c,C.value.gaAccountId,I.value.address),t.next=13,l(u,c);case 13:return t.next=15,D();case 15:s.push({name:me.QA});case 16:t.next=21;break;case 18:t.prev=18,t.t0=t["catch"](1),(0,d.ac)(t.t0);case 21:return t.prev=21,n("success"),P.value=!0,t.finish(21);case 25:case"end":return t.stop()}}),t,null,[[1,18,21,25]])})))}function Y(){return fe(this,void 0,void 0,regeneratorRuntime.mark((function t(){var n,a,r,o,i,l,u;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(n=e.transferData,a=n.amount,r=n.address,o=n.selectedAsset,i=n.note,a&&r&&o){t.next=3;break}return t.abrupt("return");case 3:if(l=o.contractId===m.ik?(0,k.Ze)(a):(0,d.Yt)(a,o.decimals),!e.isMultisig){t.next=9;break}return t.next=7,W();case 7:t.next=18;break;case 9:if(!e.isAddressUrl){t.next=14;break}return t.next=12,F({amount:l,recipient:r,selectedAsset:o,note:i});case 12:t.next=18;break;case 14:return t.next=16,L({amount:l,recipient:r,selectedAsset:o});case 16:u=t.sent,s.push({name:g.value,query:{latestTxHash:u}});case 18:case"end":return t.stop()}}),t)})))}return{PROTOCOL_AETERNITY:c.DJ,isSelectedAssetAex9:B,activeMultisigAccount:C,AE_SYMBOL:m.WJ,AE_CONTRACT_ID:m.ik,PROPOSE_TRANSACTION_FEE:N,loading:P,submit:Y}}}),Ae=(0,$.Z)(ge,[["render",de],["__scopeId","data-v-201fc13a"]]),Te=Ae,he=(0,a.aZ)({name:c.Nj,components:{TransferSendBase:v.Z},props:{resolve:{type:Function,default:function(){return null}},tokenContractId:{type:String,default:null},address:{type:String,default:null},isMultisig:Boolean},setup:function(e){var t,n=(0,i.QT)(),r=n.t,v=(0,l.oR)(),f=(0,p.cn)({store:v}),g=f.isAeNodeReady,A=(0,o.iH)(),T=(0,o.iH)(c.Nz.form),h=(0,o.iH)(!1),w=(0,o.iH)({amount:"",selectedAsset:void 0,payload:""}),x=(0,u.eJ)("fungibleTokens","availableTokens"),b=(0,a.Fl)((function(){var e;return!!(null===(e=w.value.address)||void 0===e?void 0:e.endsWith(m.Dq))})),k=(0,a.Fl)((function(){return!b.value&&w.value.address&&(0,d.pM)(w.value.address)})),y=(0,a.Fl)((function(){return h.value||!g.value||!w.value.address||!w.value.amount})),O=(0,a.Fl)((function(){return e.isMultisig?r("modals.multisigTxProposal.proposeAndApprove"):""}));function _(){A.value.submit()}function I(){T.value=k.value?c.Nz.reviewTip:c.Nz.review}function M(){T.value=c.Nz.review}function C(){e.resolve()}function R(){h.value=!1,T.value=c.Nz.form}var D=(t={},(0,s.Z)(t,c.Nz.form,{component:j,onSuccess:I}),(0,s.Z)(t,c.Nz.reviewTip,{component:ue,onSuccess:M}),(0,s.Z)(t,c.Nz.review,{component:Te,onSuccess:C}),t),E=(0,a.Fl)((function(){return D[T.value]}));return e.tokenContractId&&x.value[e.tokenContractId]&&(w.value.selectedAsset=x.value[e.tokenContractId]),e.address&&(w.value.address=e.address),{TRANSFER_SEND_STEPS:c.Nz,PROTOCOL_AETERNITY:c.DJ,currentRenderedComponent:A,steps:D,currentStep:T,error:h,transferData:w,currentStepConfig:E,isAddressChain:b,isAddressUrl:k,isPrimaryButtonDisabled:y,customPrimaryButtonText:O,proceedToNextStep:_,editTransfer:R}}}),we=(0,$.Z)(he,[["render",r]]),xe=we}}]);