"use strict";(self["webpackChunksuperhero_wallet"]=self["webpackChunksuperhero_wallet"]||[]).push([[899],{45649:(e,t,n)=>{n.r(t),n.d(t,{default:()=>ee});var r=n(66252);function a(e,t,n,a,o,s){var u=(0,r.up)("TransferSendBase");return(0,r.wg)(),(0,r.j4)(u,(0,r.dG)(e.$attrs,{protocol:e.PROTOCOL_BITCOIN,"current-step":e.currentStep,"edit-transfer":e.editTransfer,"proceed-to-next-step":e.proceedToNextStep,"primary-button-disabled":e.error||!e.transferData.address||!e.transferData.amount,onClose:e.resolve}),{content:(0,r.w5)((function(){return[((0,r.wg)(),(0,r.j4)((0,r.LL)(e.currentStepConfig.component),{ref:"currentRenderedComponent",transferData:e.transferData,"onUpdate:transferData":t[0]||(t[0]=function(t){return e.transferData=t}),onSuccess:e.currentStepConfig.onSuccess,onError:t[1]||(t[1]=function(t){return e.error=t})},null,40,["transferData","onSuccess"]))]})),_:1},16,["protocol","current-step","edit-transfer","proceed-to-next-step","primary-button-disabled","onClose"])}var o=n(62118),s=n(2262),u=n(33907),i=n(16982),c=n(37335),l=n(79323),d=n(71584);function f(e,t,n,a,o,s){var u=(0,r.up)("TokenAmount"),i=(0,r.up)("DetailsItem"),c=(0,r.up)("TransferReviewBase");return(0,r.wg)(),(0,r.j4)(c,{"base-token-symbol":e.BTC_SYMBOL,"transfer-data":e.transferData,loading:e.loading,"show-fiat":"",protocol:e.PROTOCOL_BITCOIN,class:"transfer-review"},{total:(0,r.w5)((function(){return[(0,r.Wm)(i,{label:e.$t("common.total"),class:"details-item"},{value:(0,r.w5)((function(){return[(0,r.Wm)(u,{amount:+e.transferData.total,symbol:e.BTC_SYMBOL,"high-precision":"",protocol:e.PROTOCOL_BITCOIN,"data-cy":"review-total"},null,8,["amount","symbol","protocol"])]})),_:1},8,["label"])]})),_:1},8,["base-token-symbol","transfer-data","loading","protocol"])}n(35666),n(41539);var m=n(22201),p=n(79150),v=n(12120),T=n(95951),w=n(15990),O=n(3437),_=n(70794),S=function(e,t,n,r){function a(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,o){function s(e){try{i(r.next(e))}catch(t){o(t)}}function u(e){try{i(r["throw"](e))}catch(t){o(t)}}function i(e){e.done?n(e.value):a(e.value).then(s,u)}i((r=r.apply(e,t||[])).next())}))};const g=(0,r.aZ)({name:"BtcTransferReview",components:{TokenAmount:w.Z,DetailsItem:T.Z,TransferReviewBase:v.Z},model:{prop:"transferData"},props:{transferData:{type:Object,required:!0}},setup:function(e,t){var n=t.emit,r=(0,p.QT)(),a=r.t,o=(0,m.tv)(),c=(0,i.bl)(),f=c.homeRouteName,v=(0,i.ol)(),T=v.openDefaultModal,w=(0,u.oR)(),g=(0,i.xe)({store:w}),h=g.activeAccount,C=(0,s.iH)(!1);function b(e){T({title:a("modals.transaction-failed.msg"),icon:"critical",msg:e})}function N(e){var t=document.createElement("textarea");return t.textContent=e,t.innerHTML}function I(t){var n,r=t.amount,a=t.recipient;t.selectedAsset;return S(this,void 0,void 0,regeneratorRuntime.mark((function t(){var o,s,u;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return o=d.l.getAdapter(l.ou),t.prev=1,C.value=!0,t.next=5,o.spend((0,_.Z)(r).toNumber(),a,Object.assign({fee:null===(n=e.transferData.fee)||void 0===n?void 0:n.toNumber()},h.value));case 5:return s=t.sent,u=s.hash,t.abrupt("return",u);case 10:throw t.prev=10,t.t0=t["catch"](1),b(N(t.t0.message)),t.t0;case 14:return t.prev=14,C.value=!1,t.finish(14);case 17:case"end":return t.stop()}}),t,null,[[1,10,14,17]])})))}function B(){return S(this,void 0,void 0,regeneratorRuntime.mark((function t(){var r,a,s,u;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(r=e.transferData,a=r.amount,s=r.address,u=r.selectedAsset,a&&s&&u){t.next=3;break}return t.abrupt("return");case 3:return t.next=5,I({amount:a,recipient:s,selectedAsset:u});case 5:t.sent,o.push({name:f.value}),n("success");case 8:case"end":return t.stop()}}),t)})))}return{PROTOCOL_BITCOIN:l.ou,BTC_SYMBOL:O.ir,BTC_CONTRACT_ID:O.Nd,loading:C,submit:B}}});var h=n(83744);const C=(0,h.Z)(g,[["render",f],["__scopeId","data-v-602d1c1d"]]),b=C;n(96647),n(83710),n(39714);var N=n(3577),I=n(49963);function B(e,t,n,a,o,s){var u=(0,r.up)("TransferSendRecipient"),i=(0,r.up)("BtnPlain"),c=(0,r.up)("TransferSendAmount"),l=(0,r.up)("TransactionSpeedPicker"),d=(0,r.up)("DetailsItem"),f=(0,r.up)("TransferSendFormBase");return(0,r.wg)(),(0,r.j4)(f,(0,r.dG)(e.$attrs,{"transfer-data":e.transferData,fee:e.numericFee,"fee-symbol":e.BTC_SYMBOL,protocol:e.PROTOCOL_BITCOIN,"custom-title":e.$t("modals.send.sendAsset",{name:e.BTC_COIN_NAME}),class:"transfer-send-form"}),{recipient:(0,r.w5)((function(){return[(0,r.Wm)(u,{modelValue:e.formModel.address,"onUpdate:modelValue":t[0]||(t[0]=function(t){return e.formModel.address=t}),modelModifiers:{trim:!0},placeholder:e.$t("modals.send.recipientPlaceholderProtocol",{name:e.PROTOCOL_BITCOIN}),errors:e.errors,protocol:e.PROTOCOL_BITCOIN,"validation-rules":{address_btc:[e.activeNetwork.type]},onOpenQrModal:e.openScanQrModal},null,8,["modelValue","placeholder","errors","protocol","validation-rules","onOpenQrModal"])]})),amount:(0,r.w5)((function(){return[(0,r.Wm)(c,{modelValue:e.formModel.amount,"onUpdate:modelValue":t[1]||(t[1]=function(t){return e.formModel.amount=t}),errors:e.errors,"selected-asset":e.formModel.selectedAsset,readonly:"",protocol:e.PROTOCOL_BITCOIN,"validation-rules":Object.assign(Object.assign(Object.assign({},+e.balance.minus(e.fee)>0?{max_value:e.max.toString()}:{}),{enough_coin:[e.fee.toString(),e.BTC_SYMBOL]}),e.activeNetwork.type===e.NETWORK_TYPE_TESTNET?{}:{min_value_exclusive:e.toBitcoin(e.DUST_AMOUNT)}),onAssetSelected:e.handleAssetChange},{"label-after":(0,r.w5)((function(){return[(0,r.Wm)(i,{class:(0,N.C_)(["max-button",{chosen:e.formModel.amount.toString()===e.max.toString()}]),onClick:e.setMaxAmount},{default:(0,r.w5)((function(){return[(0,r.Uk)((0,N.zw)(e.$t("common.max")),1)]})),_:1},8,["class","onClick"])]})),_:1},8,["modelValue","errors","selected-asset","protocol","validation-rules","onAssetSelected"])]})),extra:(0,r.w5)((function(){return[(0,r.wy)((0,r._)("div",null,[(0,r.Wm)(d,{label:e.$t("modals.send.transactionSpeed")},{value:(0,r.w5)((function(){return[(0,r.Wm)(l,{"fee-list":e.feeList,onChangeFee:t[2]||(t[2]=function(t){return e.setFee(t)})},null,8,["fee-list"])]})),_:1},8,["label"])],512),[[I.F8,e.activeNetwork.type!==e.NETWORK_TYPE_TESTNET]])]})),_:1},16,["transfer-data","fee","fee-symbol","protocol","custom-title"])}n(56977);var R=n(51993),D=n(94277),x=n(2114),A=n(48854),Z=n(43647),y=n(89234),M=n(63530),k=n(51877),P={class:"transaction-speed-picker"},E={class:"radio-wrapper"},L={key:0,class:"completion-time"};function F(e,t,n,a,o,s){var u=(0,r.up)("RadioButton");return(0,r.wg)(),(0,r.iD)("div",P,[(0,r._)("div",E,[((0,r.wg)(!0),(0,r.iD)(r.HY,null,(0,r.Ko)(e.feeList,(function(t,n){return(0,r.wg)(),(0,r.j4)(u,{key:t,value:e.selectedIndex===n,onInput:function(t){return e.handleInput(n)}},{default:(0,r.w5)((function(){return[(0,r._)("p",null,(0,N.zw)(e.labels[n]),1)]})),_:2},1032,["value","onInput"])})),128))]),e.UNFINISHED_FEATURES?((0,r.wg)(),(0,r.iD)("p",L,(0,N.zw)(e.$t("modals.send.transactionWillBeCompleted",{time:e.secondsToRelativeTime(e.feeList[e.selectedIndex].time,!0)})),1)):(0,r.kq)("",!0)])}var j=n(42502);const Y=(0,r.aZ)({components:{RadioButton:j.Z},props:{feeList:{type:Array,required:!0,validate:function(e){return 3===e.length}}},emits:["changeFee"],setup:function(e,t){var n=t.emit,a=(0,p.QT)(),o=a.t,u=(0,s.iH)(1),i=[o("common.transferSpeed.slow"),o("common.transferSpeed.medium"),o("common.transferSpeed.fast")];function c(t){u.value=t,n("changeFee",e.feeList[t].fee)}return(0,r.YP)((function(){return e.feeList}),(function(){n("changeFee",e.feeList[u.value].fee)}),{immediate:!0}),{UNFINISHED_FEATURES:l._0,labels:i,selectedIndex:u,secondsToRelativeTime:A.Kg,handleInput:c}}}),H=(0,h.Z)(Y,[["render",F],["__scopeId","data-v-6915e096"]]),U=H;var W=n(866),z=n(36172),$=n(82414),Q=n(50033),V=function(e,t,n,r){function a(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,o){function s(e){try{i(r.next(e))}catch(t){o(t)}}function u(e){try{i(r["throw"](e))}catch(t){o(t)}}function i(e){e.done?n(e.value):a(e.value).then(s,u)}i((r=r.apply(e,t||[])).next())}))};const K=(0,r.aZ)({name:"BtcTransferSendForm",components:{BtnPlain:W.Z,TransactionSpeedPicker:U,DetailsItem:T.Z,TransferSendAmount:k.Z,TransferSendRecipient:M.Z,TransferSendFormBase:y.Z},model:{prop:"transferData"},props:{transferData:{type:Object,required:!0}},emits:["update:transferData","success","error"],setup:function(e,t){var n=t.emit,a=(0,u.oR)(),o=(0,D.e)(),c=o.activeNetwork,f=(0,s.iH)(!1),m=(0,s.iH)(!1),p=(0,i.ln)({store:a}),v=p.balance,T=(0,i.xe)({store:a}),w=T.activeAccount,S=(0,x.A)({transferData:e.transferData,protocol:l.ou}),g=S.formModel,h=S.errors,C=S.hasError,b=S.invoiceId,N=S.invoiceContract,I=S.clearPayload,B=S.openScanQrModal,y=S.handleAssetChange,M=(0,s.iH)(new _.Z(0)),k=(0,s.iH)([{fee:new _.Z(2e-5),time:3540},{fee:new _.Z(4e-5),time:600},{fee:new _.Z(5e-5),time:25}]),P=(0,r.Fl)((function(){return+M.value.toFixed()})),E=(0,r.Fl)((function(){return v.value.minus(M.value)}));function L(e){M.value=e}function F(){var e,t=Object.assign(Object.assign({},g.value),{fee:M.value,total:P.value+ +((null===(e=g.value)||void 0===e?void 0:e.amount)||0),invoiceId:b.value,invoiceContract:N.value});return n("update:transferData",t),(0,r.Y3)()}function j(){return V(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(C.value){e.next=4;break}return e.next=3,F();case 3:n("success");case 4:case"end":return e.stop()}}),e)})))}function Y(){g.value.amount=E.value.isPositive()?E.value.toString():"0"}function H(){return V(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t,n,r,a,o,s;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t=d.l.getAdapter(l.ou),e.next=3,t.constructAndSignTx(0,g.value.address||w.value.address,Object.assign({fee:0},w.value));case 3:return n=e.sent.virtualSize(),r=c.value.protocols.bitcoin.nodeUrl,e.next=7,(0,A.rd)("".concat(r,"/fee-estimates"));case 7:a=e.sent["5"],o=new _.Z(.5),s=new _.Z(Math.ceil(a*n)),k.value=[{fee:new _.Z((0,R.toBitcoin)(Math.ceil(s.minus(s.times(o)).toNumber()))),time:3540},{fee:new _.Z((0,R.toBitcoin)(s.toNumber()*(c.value.type===l.Rn?2:1))),time:600},{fee:new _.Z((0,R.toBitcoin)(Math.ceil(s.plus(s.times(o)).toNumber()))),time:25}];case 11:case"end":return e.stop()}}),e)})))}var U=null;return(0,r.bv)((function(){U=(0,A.ID)((function(){H()}),5e3)})),(0,r.Ah)((function(){U&&clearInterval(U)})),(0,r.YP)(C,(function(e){return n("error",e)}),{deep:!0}),(0,r.YP)(g,(function(){F()}),{deep:!0}),{INFO_BOX_TYPES:Z._,BTC_SYMBOL:O.ir,BTC_COIN_NAME:O.uZ,DUST_AMOUNT:O.Vn,PROTOCOL_BITCOIN:l.ou,NETWORK_TYPE_TESTNET:l.Rn,hasMultisigTokenWarning:f,formModel:g,isUrlTippingEnabled:m,activeNetwork:c,fee:M,numericFee:P,activeAccount:w,feeList:k,errors:h,balance:v,max:E,clearPayload:I,openScanQrModal:B,handleAssetChange:y,setFee:L,EditIcon:z.Z,DeleteIcon:$.Z,PlusCircleIcon:Q.Z,submit:j,setMaxAmount:Y,toBitcoin:R.toBitcoin}}}),q=(0,h.Z)(K,[["render",B],["__scopeId","data-v-002535ae"]]),G=q,X=(0,r.aZ)({name:l.Nj,components:{TransferSendBase:c.Z},props:{resolve:{type:Function,default:function(){return null}},tokenContractId:{type:String,default:null},address:{type:String,default:null}},setup:function(e){var t,n=(0,u.oR)(),a=(0,i.jg)({store:n}),c=a.marketData,f=(0,i.ln)({store:n}),m=f.balance,p=(0,s.iH)(),v=(0,s.iH)(l.Nz.form),T=(0,s.iH)(!1),w=(0,s.iH)({amount:"",selectedAsset:d.l.getAdapter(l.ou).getDefaultCoin(c.value,+m.value),payload:""});function O(){p.value.submit()}function _(){v.value=l.Nz.review}function S(){e.resolve()}function g(){T.value=!1,v.value=l.Nz.form}var h=(t={},(0,o.Z)(t,l.Nz.form,{component:G,onSuccess:_}),(0,o.Z)(t,l.Nz.review,{component:b,onSuccess:S}),t),C=(0,r.Fl)((function(){return h[v.value]}));return e.address&&(w.value.address=e.address),{TRANSFER_SEND_STEPS:l.Nz,PROTOCOL_BITCOIN:l.ou,currentRenderedComponent:p,steps:h,currentStep:v,error:T,transferData:w,currentStepConfig:C,proceedToNextStep:O,editTransfer:g}}}),J=(0,h.Z)(X,[["render",a]]),ee=J}}]);