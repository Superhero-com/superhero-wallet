"use strict";(self["webpackChunksuperhero_wallet"]=self["webpackChunksuperhero_wallet"]||[]).push([[899],{61037:(e,t,n)=>{n.r(t),n.d(t,{default:()=>te});var r=n(66252);function a(e,t,n,a,o,u){var s=(0,r.up)("TransferSendBase");return(0,r.wg)(),(0,r.j4)(s,(0,r.dG)(e.$attrs,{protocol:e.PROTOCOL_BITCOIN,"current-step":e.currentStep,"edit-transfer":e.editTransfer,"proceed-to-next-step":e.proceedToNextStep,"primary-button-disabled":e.error||!e.transferData.address||!e.transferData.amount,onClose:e.resolve}),{content:(0,r.w5)((function(){return[((0,r.wg)(),(0,r.j4)((0,r.LL)(e.currentStepConfig.component),{ref:"currentRenderedComponent",transferData:e.transferData,"onUpdate:transferData":t[0]||(t[0]=function(t){return e.transferData=t}),onSuccess:e.currentStepConfig.onSuccess,onError:t[1]||(t[1]=function(t){return e.error=t})},null,40,["transferData","onSuccess"]))]})),_:1},16,["protocol","current-step","edit-transfer","proceed-to-next-step","primary-button-disabled","onClose"])}var o=n(62118),u=n(2262),s=n(33907),i=n(9697),l=n(65036),c=n(79323),d=n(71584);function f(e,t,n,a,o,u){var s=(0,r.up)("TokenAmount"),i=(0,r.up)("DetailsItem"),l=(0,r.up)("TransferReviewBase");return(0,r.wg)(),(0,r.j4)(l,{"base-token-symbol":e.BTC_SYMBOL,"transfer-data":e.transferData,loading:e.loading,"show-fiat":"",protocol:e.PROTOCOL_BITCOIN,class:"transfer-review"},{total:(0,r.w5)((function(){return[(0,r.Wm)(i,{label:e.$t("common.total"),class:"details-item"},{value:(0,r.w5)((function(){return[(0,r.Wm)(s,{amount:+e.transferData.total,symbol:e.BTC_SYMBOL,"high-precision":"",protocol:e.PROTOCOL_BITCOIN,"data-cy":"review-total"},null,8,["amount","symbol","protocol"])]})),_:1},8,["label"])]})),_:1},8,["base-token-symbol","transfer-data","loading","protocol"])}n(35666),n(41539),n(57658);var m=n(22201),p=n(79150),v=n(80746),T=n(11362),w=n(26906),O=n(3437),S=n(70794),_=function(e,t,n,r){function a(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,o){function u(e){try{i(r.next(e))}catch(t){o(t)}}function s(e){try{i(r["throw"](e))}catch(t){o(t)}}function i(e){e.done?n(e.value):a(e.value).then(u,s)}i((r=r.apply(e,t||[])).next())}))};const g=(0,r.aZ)({name:"BtcTransferReview",components:{TokenAmount:w.Z,DetailsItem:T.Z,TransferReviewBase:v.Z},model:{prop:"transferData"},props:{transferData:{type:Object,required:!0}},setup:function(e,t){var n=t.emit,r=(0,p.QT)(),a=r.t,o=(0,m.tv)(),l=(0,i.bl)(),f=l.homeRouteName,v=(0,i.ol)(),T=v.openDefaultModal,w=(0,s.oR)(),g=(0,i.xe)({store:w}),b=g.activeAccount,C=(0,u.iH)(!1);function h(e){T({title:a("modals.transaction-failed.msg"),icon:"critical",msg:e})}function N(e){var t=document.createElement("textarea");return t.textContent=e,t.innerHTML}function I(t){var n,r=t.amount,a=t.recipient;t.selectedAsset;return _(this,void 0,void 0,regeneratorRuntime.mark((function t(){var o,u,s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return o=d.l.getAdapter(c.ou),t.prev=1,C.value=!0,t.next=5,o.spend((0,S.Z)(r).toNumber(),a,Object.assign({fee:null===(n=e.transferData.fee)||void 0===n?void 0:n.toNumber()},b.value));case 5:return u=t.sent,s=u.hash,t.abrupt("return",s);case 10:throw t.prev=10,t.t0=t["catch"](1),h(N(t.t0.message)),t.t0;case 14:return t.prev=14,C.value=!1,t.finish(14);case 17:case"end":return t.stop()}}),t,null,[[1,10,14,17]])})))}function B(){return _(this,void 0,void 0,regeneratorRuntime.mark((function t(){var r,a,u,s;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(r=e.transferData,a=r.amount,u=r.address,s=r.selectedAsset,a&&u&&s){t.next=3;break}return t.abrupt("return");case 3:return t.next=5,I({amount:a,recipient:u,selectedAsset:s});case 5:t.sent,o.push({name:f.value}),n("success");case 8:case"end":return t.stop()}}),t)})))}return{PROTOCOL_BITCOIN:c.ou,BTC_SYMBOL:O.ir,BTC_CONTRACT_ID:O.Nd,loading:C,submit:B}}});var b=n(83744);const C=(0,b.Z)(g,[["render",f],["__scopeId","data-v-602d1c1d"]]),h=C;n(96647),n(83710),n(39714);var N=n(3577),I=n(49963);function B(e,t,n,a,o,u){var s=(0,r.up)("TransferSendRecipient"),i=(0,r.up)("BtnPlain"),l=(0,r.up)("TransferSendAmount"),c=(0,r.up)("TransactionSpeedPicker"),d=(0,r.up)("DetailsItem"),f=(0,r.up)("TransferSendFormBase");return(0,r.wg)(),(0,r.j4)(f,(0,r.dG)(e.$attrs,{"transfer-data":e.transferData,fee:e.numericFee,"fee-symbol":e.BTC_SYMBOL,protocol:e.PROTOCOL_BITCOIN,"custom-title":e.$t("modals.send.sendAsset",{name:e.BTC_COIN_NAME}),class:"transfer-send-form"}),{recipient:(0,r.w5)((function(){return[(0,r.Wm)(s,{modelValue:e.formModel.address,"onUpdate:modelValue":t[0]||(t[0]=function(t){return e.formModel.address=t}),modelModifiers:{trim:!0},placeholder:e.$t("modals.send.recipientPlaceholderProtocol",{name:e.PROTOCOL_BITCOIN}),errors:e.errors,protocol:e.PROTOCOL_BITCOIN,"validation-rules":{address_btc:[e.activeNetwork.type]},onOpenQrModal:e.openScanQrModal},null,8,["modelValue","placeholder","errors","protocol","validation-rules","onOpenQrModal"])]})),amount:(0,r.w5)((function(){return[(0,r.Wm)(l,{modelValue:e.formModel.amount,"onUpdate:modelValue":t[1]||(t[1]=function(t){return e.formModel.amount=t}),errors:e.errors,"selected-asset":e.formModel.selectedAsset,readonly:"",protocol:e.PROTOCOL_BITCOIN,"validation-rules":Object.assign(Object.assign(Object.assign({},+e.balance.minus(e.fee)>0?{max_value:e.max.toString()}:{}),{enough_coin:[e.fee.toString(),e.BTC_SYMBOL]}),e.activeNetwork.type===e.NETWORK_TYPE_TESTNET?{}:{min_value_exclusive:e.toBitcoin(e.DUST_AMOUNT)}),onAssetSelected:e.handleAssetChange},{"label-after":(0,r.w5)((function(){return[(0,r.Wm)(i,{class:(0,N.C_)(["max-button",{chosen:e.formModel.amount.toString()===e.max.toString()}]),onClick:e.setMaxAmount},{default:(0,r.w5)((function(){return[(0,r.Uk)((0,N.zw)(e.$t("common.max")),1)]})),_:1},8,["class","onClick"])]})),_:1},8,["modelValue","errors","selected-asset","protocol","validation-rules","onAssetSelected"])]})),extra:(0,r.w5)((function(){return[(0,r.wy)((0,r._)("div",null,[(0,r.Wm)(d,{label:e.$t("modals.send.transactionSpeed")},{value:(0,r.w5)((function(){return[(0,r.Wm)(c,{modelValue:e.feeSelectedIndex,"onUpdate:modelValue":t[2]||(t[2]=function(t){return e.feeSelectedIndex=t}),"fee-list":e.feeList},null,8,["modelValue","fee-list"])]})),_:1},8,["label"])],512),[[I.F8,e.activeNetwork.type!==e.NETWORK_TYPE_TESTNET]])]})),_:1},16,["transfer-data","fee","fee-symbol","protocol","custom-title"])}n(56977);var R=n(51993),x=n(2114),D=n(48854),y=n(36605),A=n(33741),Z=n(10938),k=n(51194),M=n(78250),E={class:"transaction-speed-picker"},P={class:"radio-wrapper"},L=["textContent"],F={key:0,class:"completion-time"};function j(e,t,n,a,o,u){var s=(0,r.up)("RadioButton");return(0,r.wg)(),(0,r.iD)("div",E,[(0,r._)("div",P,[((0,r.wg)(!0),(0,r.iD)(r.HY,null,(0,r.Ko)(e.feeList,(function(t,n){return(0,r.wg)(),(0,r.j4)(s,{key:n,value:e.modelValue===n,onInput:function(t){return e.handleInput(n)}},{default:(0,r.w5)((function(){return[(0,r._)("p",{textContent:(0,N.zw)(t.label)},null,8,L)]})),_:2},1032,["value","onInput"])})),128))]),e.UNFINISHED_FEATURES?((0,r.wg)(),(0,r.iD)("p",F,(0,N.zw)(e.$t("modals.send.transactionWillBeCompleted",{time:e.secondsToRelativeTime(e.feeList[e.modelValue].time,!0)})),1)):(0,r.kq)("",!0)])}n(9653);var H=n(70090);const U=(0,r.aZ)({components:{RadioButton:H.Z},props:{feeList:{type:Array,required:!0,validate:function(e){return 3===e.length}},modelValue:{type:Number,default:1}},emits:["update:modelValue"],setup:function(e,t){var n=t.emit;function r(e){n("update:modelValue",e)}return{UNFINISHED_FEATURES:c._0,secondsToRelativeTime:D.Kg,handleInput:r}}}),V=(0,b.Z)(U,[["render",j],["__scopeId","data-v-0223bf77"]]),Y=V;var W=n(85721),z=n(28255),$=n(86311),Q=n(43625),K=function(e,t,n,r){function a(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,o){function u(e){try{i(r.next(e))}catch(t){o(t)}}function s(e){try{i(r["throw"](e))}catch(t){o(t)}}function i(e){e.done?n(e.value):a(e.value).then(u,s)}i((r=r.apply(e,t||[])).next())}))};const q=(0,r.aZ)({name:"BtcTransferSendForm",components:{BtnPlain:W.Z,TransactionSpeedPicker:Y,DetailsItem:T.Z,TransferSendAmount:M.Z,TransferSendRecipient:k.Z,TransferSendFormBase:Z.Z},model:{prop:"transferData"},props:{transferData:{type:Object,required:!0}},emits:["update:transferData","success","error"],setup:function(e,t){var n=t.emit,a=d.l.getAdapter(c.ou),o=(0,s.oR)(),l=(0,p.QT)(),f=l.t,m=(0,i.e9)(),v=m.activeNetwork,T=(0,u.iH)(!1),w=(0,u.iH)(!1),_=(0,i.ln)({store:o}),g=_.balance,b=(0,i.xe)({store:o}),C=b.activeAccount,h=(0,x.A)({transferData:e.transferData,protocol:c.ou}),N=h.formModel,I=h.errors,B=h.hasError,Z=h.invoiceId,k=h.invoiceContract,M=h.clearPayload,E=h.openScanQrModal,P=h.handleAssetChange,L=(0,u.iH)(1),F=(0,u.iH)(new S.Z(2e-5)),j=(0,u.iH)(new S.Z(2e-5)),H=(0,u.iH)(new S.Z(2e-5)),U=(0,r.Fl)((function(){return[{fee:F.value,time:3540,label:f("common.transferSpeed.slow")},{fee:j.value,time:600,label:f("common.transferSpeed.medium")},{fee:H.value,time:25,label:f("common.transferSpeed.fast")}]})),V=(0,r.Fl)((function(){return U.value[L.value].fee})),Y=(0,r.Fl)((function(){return+V.value.toFixed()})),W=(0,r.Fl)((function(){return g.value.minus(V.value)}));function q(){var e,t=Object.assign(Object.assign({},N.value),{fee:V.value,total:Y.value+ +((null===(e=N.value)||void 0===e?void 0:e.amount)||0),invoiceId:Z.value,invoiceContract:k.value});return n("update:transferData",t),(0,r.Y3)()}function G(){return K(this,void 0,void 0,regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(B.value){e.next=4;break}return e.next=3,q();case 3:n("success");case 4:case"end":return e.stop()}}),e)})))}function X(){N.value.amount=W.value.isPositive()?W.value.toString():"0"}function J(){return K(this,void 0,void 0,regeneratorRuntime.mark((function e(){var t,n,r,o,u;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,a.constructAndSignTx(0,N.value.address||C.value.address,Object.assign({fee:0},C.value));case 3:return t=e.sent.virtualSize(),n=v.value.protocols.bitcoin.nodeUrl,e.next=7,(0,D.rd)("".concat(n,"/fee-estimates"));case 7:r=e.sent["5"],o=new S.Z(.5),u=new S.Z(Math.ceil(r*t)),F.value=new S.Z((0,R.toBitcoin)(Math.ceil(u.minus(u.times(o)).toNumber()))),j.value=new S.Z((0,R.toBitcoin)(u.toNumber()*(v.value.type===c.Rn?2:1))),H.value=new S.Z((0,R.toBitcoin)(Math.ceil(u.plus(u.times(o)).toNumber()))),e.next=18;break;case 15:e.prev=15,e.t0=e["catch"](0),y.Z.write(e.t0);case 18:case"end":return e.stop()}}),e,null,[[0,15]])})))}var ee=null;return(0,r.bv)((function(){ee=(0,D.ID)((function(){J()}),5e3)})),(0,r.Ah)((function(){ee&&clearInterval(ee)})),(0,r.YP)(B,(function(e){return n("error",e)}),{deep:!0}),(0,r.YP)(N,(function(){q()}),{deep:!0}),{INFO_BOX_TYPES:A._,BTC_SYMBOL:O.ir,BTC_COIN_NAME:O.uZ,DUST_AMOUNT:O.Vn,PROTOCOL_BITCOIN:c.ou,NETWORK_TYPE_TESTNET:c.Rn,hasMultisigTokenWarning:T,formModel:N,isUrlTippingEnabled:w,activeNetwork:v,fee:V,feeList:U,feeSelectedIndex:L,numericFee:Y,activeAccount:C,errors:I,balance:g,max:W,clearPayload:M,openScanQrModal:E,handleAssetChange:P,EditIcon:z.Z,DeleteIcon:$.Z,PlusCircleIcon:Q.Z,submit:G,setMaxAmount:X,toBitcoin:R.toBitcoin}}}),G=(0,b.Z)(q,[["render",B],["__scopeId","data-v-2fc8e97d"]]),X=G,J=(0,r.aZ)({name:c.Nj,components:{TransferSendBase:l.Z},props:{resolve:{type:Function,default:function(){return null}},tokenContractId:{type:String,default:null},address:{type:String,default:null},amount:{type:String,default:""},payload:{type:String,default:""}},setup:function(e){var t,n=(0,s.oR)(),a=(0,i.jg)({store:n}),l=a.marketData,f=(0,i.ln)({store:n}),m=f.balance,p=(0,u.iH)(),v=(0,u.iH)(c.Nz.form),T=(0,u.iH)(!1),w=(0,u.iH)({amount:e.amount,selectedAsset:d.l.getAdapter(c.ou).getDefaultCoin(l.value,+m.value),payload:e.payload});function O(){p.value.submit()}function S(){v.value=c.Nz.review}function _(){e.resolve()}function g(){T.value=!1,v.value=c.Nz.form}var b=(t={},(0,o.Z)(t,c.Nz.form,{component:X,onSuccess:S}),(0,o.Z)(t,c.Nz.review,{component:h,onSuccess:_}),t),C=(0,r.Fl)((function(){return b[v.value]}));return e.address&&(w.value.address=e.address),{TRANSFER_SEND_STEPS:c.Nz,PROTOCOL_BITCOIN:c.ou,currentRenderedComponent:p,steps:b,currentStep:v,error:T,transferData:w,currentStepConfig:C,proceedToNextStep:O,editTransfer:g}}}),ee=(0,b.Z)(J,[["render",a]]),te=ee}}]);