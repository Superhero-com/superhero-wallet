"use strict";(self["webpackChunksuperhero_wallet"]=self["webpackChunksuperhero_wallet"]||[]).push([[551],{99731:(e,t,n)=>{n.r(t),n.d(t,{default:()=>Q});var r=n(20641);function a(e,t,n,a,o,u){var s=(0,r.g2)("TransferSendBase");return(0,r.uX)(),(0,r.Wv)(s,{"current-step":e.currentStep,"sending-disabled":e.error||!e.transferData.address||!e.transferData.amount,onClose:e.resolve,onStepNext:e.proceedToNextStep,onStepPrev:e.editTransfer},{content:(0,r.k6)((function(){return[((0,r.uX)(),(0,r.Wv)((0,r.$y)(e.currentStepConfig.component),{ref:"currentRenderedComponent",transferData:e.transferData,"onUpdate:transferData":t[0]||(t[0]=function(t){return e.transferData=t}),onSuccess:e.currentStepConfig.onSuccess,onError:t[1]||(t[1]=function(t){return e.error=t})},null,40,["transferData","onSuccess"]))]})),_:1},8,["current-step","sending-disabled","onClose","onStepNext","onStepPrev"])}var o=n(41856),u=n(50953),s=n(18743),l=n(11873),i=n(46135);function c(e,t,n,a,o,u){var s=(0,r.g2)("TokenAmount"),l=(0,r.g2)("DetailsItem"),i=(0,r.g2)("TransferReviewBase");return(0,r.uX)(),(0,r.Wv)(i,{"base-token-symbol":e.ETH_COIN_SYMBOL,"transfer-data":e.transferData,loading:e.loading,protocol:e.PROTOCOLS.ethereum,"show-fiat":e.isSelectedAssetEthCoin,class:"transfer-review"},{total:(0,r.k6)((function(){return[e.isSelectedAssetEthCoin?((0,r.uX)(),(0,r.Wv)(l,{key:0,label:e.$t("common.total"),class:"details-item"},{value:(0,r.k6)((function(){return[(0,r.bF)(s,{amount:+e.transferData.total,symbol:e.ETH_COIN_SYMBOL,protocol:e.PROTOCOLS.ethereum,"data-cy":"review-total","high-precision":""},null,8,["amount","symbol","protocol"])]})),_:1},8,["label"])):(0,r.Q3)("",!0)]})),_:1},8,["base-token-symbol","transfer-data","loading","protocol","show-fiat"])}var d=n(34916),v=(n(44114),n(2892),n(26099),n(75220)),f=n(46992),m=n(87087),p=n(92032),x=n(40629),h=n(65858),A=n(18240),S=function(e,t,n,r){function a(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,o){function u(e){try{l(r.next(e))}catch(t){o(t)}}function s(e){try{l(r["throw"](e))}catch(t){o(t)}}function l(e){e.done?n(e.value):a(e.value).then(u,s)}l((r=r.apply(e,t||[])).next())}))};const P=(0,r.pM)({name:"EthTransferReview",components:{TokenAmount:A.A,DetailsItem:h.A,TransferReviewBase:x.A},model:{prop:"transferData"},props:{transferData:{type:Object,required:!0}},setup:function(e,t){var n=t.emit,a=(0,f.s9)(),o=a.t,i=(0,v.rd)(),c=(0,l.mv)(),x=c.homeRouteName,h=(0,l.U8)(),A=h.openDefaultModal,P=(0,l.oV)(),T=P.getLastActiveProtocolAccount,w=(0,l.rb)(),b=w.addAccountPendingTransaction,g=(0,u.KR)(!1),O=m.C.getAdapter(s.yv.ethereum),y=(0,r.EW)((function(){var t,n;return(null===(n=null===(t=e.transferData)||void 0===t?void 0:t.selectedAsset)||void 0===n?void 0:n.contractId)===O.coinContractId}));function F(e){A({title:o("modals.transaction-failed.msg"),icon:"critical",msg:e})}function k(){var t;return S(this,void 0,void 0,(0,d.A)().mark((function r(){var a,o,u,l,c,v,f;return(0,d.A)().wrap((function(r){while(1)switch(r.prev=r.next){case 0:if(a=e.transferData,o=a.amount,u=a.address,l=a.selectedAsset,o&&u&&l){r.next=3;break}return r.abrupt("return");case 3:if(g.value=!0,v=T(s.yv.ethereum),r.prev=5,y.value){r.next=12;break}return r.next=9,null===(t=O.transferToken)||void 0===t?void 0:t.call(O,o,u,l.contractId,{fromAccount:null===v||void 0===v?void 0:v.address,maxPriorityFeePerGas:e.transferData.maxPriorityFeePerGas,maxFeePerGas:e.transferData.maxFeePerGas});case 9:c=r.sent,r.next=15;break;case 12:return r.next=14,O.spend(Number(o),u,{fromAccount:null===v||void 0===v?void 0:v.address,maxPriorityFeePerGas:e.transferData.maxPriorityFeePerGas,maxFeePerGas:e.transferData.maxFeePerGas});case 14:c=r.sent;case 15:c&&(f={hash:c.hash,pending:!0,transactionOwner:null===v||void 0===v?void 0:v.address,protocol:s.yv.ethereum,tx:{amount:Number(o),callerId:null===v||void 0===v?void 0:v.address,contractId:l.contractId,senderId:null===v||void 0===v?void 0:v.address,type:y.value?"SpendTx":"ContractCallTx",function:"transfer",recipientId:u,arguments:[],fee:0}},b(null===v||void 0===v?void 0:v.address,f)),r.next=22;break;case 18:throw r.prev=18,r.t0=r["catch"](5),F(r.t0.message),r.t0;case 22:return r.prev=22,g.value=!1,r.finish(22);case 25:i.push({name:x.value}),n("success");case 27:case"end":return r.stop()}}),r,null,[[5,18,22,25]])})))}return{PROTOCOLS:s.yv,ETH_COIN_SYMBOL:p.xU,loading:g,isSelectedAssetEthCoin:y,submit:k}}});var T=n(66262);const w=(0,T.A)(P,[["render",c],["__scopeId","data-v-21c3bf53"]]),b=w;n(76918),n(23288),n(38781);var g=n(53751);function O(e,t,n,a,o,u){var s=(0,r.g2)("TransferSendRecipient"),l=(0,r.g2)("BtnMaxAmount"),i=(0,r.g2)("TransferSendAmount"),c=(0,r.g2)("TransactionSpeedPicker"),d=(0,r.g2)("DetailsItem"),v=(0,r.g2)("TransferSendFormBase");return(0,r.uX)(),(0,r.Wv)(v,(0,r.v6)(e.$attrs,{"transfer-data":e.transferData,fee:e.numericFee,"max-fee":e.numericMaxFee,"fee-symbol":e.ETH_COIN_SYMBOL,protocol:e.PROTOCOLS.ethereum,"custom-title":e.$t("modals.send.sendAsset",{name:e.ETH_PROTOCOL_NAME}),class:"transfer-send-form"}),{recipient:(0,r.k6)((function(){return[(0,r.bF)(s,{modelValue:e.formModel.address,"onUpdate:modelValue":t[0]||(t[0]=function(t){return e.formModel.address=t}),modelModifiers:{trim:!0},placeholder:e.recipientPlaceholderText,errors:e.errors,protocol:e.PROTOCOLS.ethereum,"validation-rules":{account_address:[e.PROTOCOLS.ethereum]},onOpenQrModal:t[1]||(t[1]=function(t){return e.scanTransferQrCode()})},null,8,["modelValue","placeholder","errors","protocol","validation-rules"])]})),amount:(0,r.k6)((function(){return[(0,r.bF)(i,{modelValue:e.formModel.amount,"onUpdate:modelValue":[t[2]||(t[2]=function(t){return e.formModel.amount=t}),t[3]||(t[3]=function(t){return e.shouldUseMaxAmount=!1})],errors:e.errors,"selected-asset":e.formModel.selectedAsset,protocol:e.PROTOCOLS.ethereum,"blink-on-change":e.shouldUseMaxAmount,"validation-rules":Object.assign(Object.assign({},+e.balance.minus(e.maxFee)>0?{max_value:e.max}:{}),{enough_coin:[e.maxFee.toString(),e.ETH_COIN_SYMBOL]}),onAssetSelected:e.handleAssetChange},{"label-after":(0,r.k6)((function(){return[(0,r.bF)(l,{"is-max":e.shouldUseMaxAmount,onClick:e.toggleMaxAmount},null,8,["is-max","onClick"])]})),_:1},8,["modelValue","errors","selected-asset","protocol","blink-on-change","validation-rules","onAssetSelected"])]})),extra:(0,r.k6)((function(){return[(0,r.bo)((0,r.bF)(d,{label:e.$t("modals.send.transactionSpeed")},{value:(0,r.k6)((function(){return[(0,r.bF)(c,{modelValue:e.feeSelectedIndex,"onUpdate:modelValue":t[4]||(t[4]=function(t){return e.feeSelectedIndex=t}),"fee-list":e.feeList},null,8,["modelValue","fee-list"])]})),_:1},8,["label"]),[[g.aG,e.activeNetwork.type!==e.NETWORK_TYPE_TESTNET]])]})),_:1},16,["transfer-data","fee","max-fee","fee-symbol","protocol","custom-title"])}n(28706),n(50113),n(9868);var y=n(60346),F=n(37061),k=n(38653),C=n(36311),E=function(e,t,n,r){function a(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,o){function u(e){try{l(r.next(e))}catch(t){o(t)}}function s(e){try{l(r["throw"](e))}catch(t){o(t)}}function l(e){e.done?n(e.value):a(e.value).then(u,s)}l((r=r.apply(e,t||[])).next())}))},D={slow:1,medium:1.5,fast:2};function I(){var e=(0,C.G)(),t=e.ethActiveNetworkSettings,n=(0,f.s9)(),a=n.t,o=(0,u.KR)(0),s=(0,u.KR)(p.un),l=(0,u.KR)(new y.A(0)),i=(0,u.KR)(new y.A(0)),c=(0,u.KR)(new y.A(0)),v=(0,r.EW)((function(){return i.value.multipliedBy(D.slow)})),m=(0,r.EW)((function(){return i.value.multipliedBy(D.medium)})),x=(0,r.EW)((function(){return i.value.multipliedBy(D.fast)})),h=(0,r.EW)((function(){return[{fee:l.value.plus(v.value).multipliedBy(s.value),time:300,label:a("common.transferSpeed.slow"),maxPriorityFee:v.value,maxFeePerGas:c.value.plus(v.value)},{fee:l.value.plus(m.value).multipliedBy(s.value),time:180,label:a("common.transferSpeed.medium"),maxPriorityFee:m.value,maxFeePerGas:c.value.plus(m.value)},{fee:l.value.plus(x.value).multipliedBy(s.value),time:30,label:a("common.transferSpeed.fast"),maxPriorityFee:x.value,maxFeePerGas:c.value.plus(x.value)}]})),A=(0,r.EW)((function(){return h.value[o.value].fee})),S=(0,r.EW)((function(){return h.value[o.value].maxFeePerGas})),P=(0,r.EW)((function(){return h.value[o.value].maxPriorityFee})),T=(0,r.EW)((function(){return S.value.multipliedBy(s.value)}));function w(e){return E(this,void 0,void 0,(0,d.A)().mark((function n(){var r,a,o;return(0,d.A)().wrap((function(n){while(1)switch(n.prev=n.next){case 0:return s.value=null!==e&&void 0!==e?e:p.un,r=t.value.nodeUrl,a=new F.PT(r),n.next=5,a.calculateFeeData();case 5:o=n.sent,l.value=new y.A((0,k.kX)(o.baseFeePerGas,"ether")),c.value=new y.A((0,k.kX)(o.maxFeePerGas,"ether")),i.value=new y.A((0,k.kX)(o.maxPriorityFeePerGas,"ether"));case 9:case"end":return n.stop()}}),n)})))}return{fee:A,feeList:h,feeSelectedIndex:o,maxFeePerGas:S,maxPriorityFeePerGas:P,maxFee:T,updateFeeList:w}}var _=n(34620),M=n(70097);function R(e){var t=e.formModel,n=e.fee,a=(0,l.ty)(),o=a.balance,u=(0,r.EW)((function(){var e,n,r=m.C.getAdapter(s.yv.ethereum);return(null===(n=null===(e=t.value)||void 0===e?void 0:e.selectedAsset)||void 0===n?void 0:n.contractId)===r.coinContractId})),i=(0,r.EW)((function(){var e,n;return new y.A((0,M.Y9)(null===(e=t.value.selectedAsset)||void 0===e?void 0:e.amount,-((null===(n=t.value.selectedAsset)||void 0===n?void 0:n.decimals)||-0))||0)})),c=(0,r.EW)((function(){if(o.value&&u.value){var e=o.value.minus(n.value);return(e.isPositive()?e:0).toString()}return i.value.toString()}));return{max:c}}var N=n(57870),B=n(10483),G=n(40114),L=n(41924),W=n(27481),V=n(31650),j=function(e,t,n,r){function a(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,o){function u(e){try{l(r.next(e))}catch(t){o(t)}}function s(e){try{l(r["throw"](e))}catch(t){o(t)}}function l(e){e.done?n(e.value):a(e.value).then(u,s)}l((r=r.apply(e,t||[])).next())}))};const K=(0,r.pM)({name:"EthTransferSendForm",components:{BtnMaxAmount:V.A,TransactionSpeedPicker:W.A,DetailsItem:h.A,TransferSendAmount:L.A,TransferSendRecipient:G.A,TransferSendFormBase:B.A},model:{prop:"transferData"},props:{transferData:{type:Object,required:!0}},emits:["update:transferData","success","error"],setup:function(e,t){var n=this,a=t.emit,o=(0,v.lq)(),i=(0,f.s9)(),c=i.t,x=(0,l.fI)(),h=x.activeNetwork,A=(0,l.ZN)(),S=A.marketData,P=(0,l.ty)(),T=P.balance,w=(0,l.oV)(),b=w.activeAccount,g=I(),O=g.fee,F=g.maxFee,k=g.feeList,E=g.feeSelectedIndex,D=g.maxFeePerGas,B=g.maxPriorityFeePerGas,G=g.updateFeeList,L=(0,l.Sr)(),W=L.accountAssets,V=(0,C.G)(),K=V.ethActiveNetworkSettings;function U(e,t){return e?W.value.find((function(t){var n=t.contractId;return n===e})):t?void 0:m.C.getAdapter(s.yv.ethereum).getDefaultCoin(S.value,+T.value)}var Y=(0,_.x)({transferData:e.transferData,getSelectedAssetValue:U}),X=Y.formModel,H=Y.errors,Q=Y.hasError,$=Y.invoiceId,q=Y.invoiceContract,z=Y.scanTransferQrCode,Z=Y.handleAssetChange,J=Y.updateFormModelValues,ee=(0,u.KR)(!1),te=R({formModel:X,fee:F}),ne=te.max,re=(0,r.EW)((function(){return+O.value.toFixed()})),ae=(0,r.EW)((function(){return+F.value.toFixed()})),oe="".concat(c("modals.send.recipientPlaceholderProtocol",{name:s.yv.ethereum})," ").concat(c("modals.send.recipientPlaceholderENS"));function ue(){var e,t,n,o=Object.assign(Object.assign({},X.value),{fee:O.value,maxFeePerGas:null===(e=D.value)||void 0===e?void 0:e.toFormat(p.hj),maxPriorityFeePerGas:null===(t=B.value)||void 0===t?void 0:t.toFormat(p.hj),total:re.value+ +((null===(n=X.value)||void 0===n?void 0:n.amount)||0),invoiceId:$.value,invoiceContract:q.value});return a("update:transferData",o),(0,r.dY)()}function se(){return j(this,void 0,void 0,(0,d.A)().mark((function e(){return(0,d.A)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(Q.value){e.next=4;break}return e.next=3,ue();case 3:a("success");case 4:case"end":return e.stop()}}),e)})))}function le(){ee.value=!ee.value,ee.value&&(X.value.amount=ne.value)}function ie(){var t,n,r,a=new y.A(X.value.amount);if("ethereum"!==(null===(t=e.transferData.selectedAsset)||void 0===t?void 0:t.contractId)&&a.gt(0)&&X.value.address){var o=K.value.nodeUrl;return(0,N.b)(null===(n=X.value.selectedAsset)||void 0===n?void 0:n.contractId,X.value.address,null===(r=b.value)||void 0===r?void 0:r.address,a,o)}}var ce=null;return(0,r.sV)((function(){var t;ce=(0,M.mX)((function(){return j(n,void 0,void 0,(0,d.A)().mark((function e(){return(0,d.A)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.t0=G,e.next=3,ie();case 3:e.t1=e.sent,(0,e.t0)(e.t1);case 5:case"end":return e.stop()}}),e)})))}),5e3);var r=o.query;J(Object.assign(Object.assign({},r),{token:r.token||(null===(t=e.transferData.selectedAsset)||void 0===t?void 0:t.contractId)}))})),(0,r.hi)((function(){ce&&clearInterval(ce)})),(0,r.wB)((function(){return X.value.selectedAsset}),(function(){return j(n,void 0,void 0,(0,d.A)().mark((function e(){return(0,d.A)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.t0=G,e.next=3,ie();case 3:e.t1=e.sent,(0,e.t0)(e.t1);case 5:case"end":return e.stop()}}),e)})))})),(0,r.wB)(ne,(function(e){ee.value&&(X.value.amount=e)})),(0,r.wB)(Q,(function(e){return a("error",e)}),{deep:!0}),(0,r.wB)(X,(function(){ue()}),{deep:!0}),{ETH_PROTOCOL_NAME:p.Dz,ETH_COIN_SYMBOL:p.xU,PROTOCOLS:s.yv,NETWORK_TYPE_TESTNET:s.Oj,formModel:X,activeNetwork:h,maxFee:F,feeList:k,recipientPlaceholderText:oe,feeSelectedIndex:E,numericFee:re,numericMaxFee:ae,errors:H,balance:T,max:ne,shouldUseMaxAmount:ee,scanTransferQrCode:z,handleAssetChange:Z,submit:se,toggleMaxAmount:le}}}),U=(0,T.A)(K,[["render",O]]),Y=U,X=(0,r.pM)({name:s.iP,components:{TransferSendBase:i.A},props:Object.assign(Object.assign({},i.g),{tokenContractId:{type:String,default:null}}),setup:function(e){var t=(0,l.Y7)(),n=t.getProtocolAvailableTokens,a=(0,r.EW)((function(){return n(s.yv.ethereum)})),i=(0,u.KR)(),c=(0,u.KR)(s.x0.form),d=(0,u.KR)(!1),v=(0,u.KR)({address:e.address,amount:e.amount,payload:e.payload,selectedAsset:e.tokenContractId?a.value[e.tokenContractId]:void 0});function f(){i.value.submit()}function m(){c.value=s.x0.review}function p(){d.value=!1,c.value=s.x0.form}var x=(0,o.A)((0,o.A)({},s.x0.form,{component:Y,onSuccess:m}),s.x0.review,{component:b,onSuccess:e.resolve}),h=(0,r.EW)((function(){return x[c.value]}));return{TRANSFER_SEND_STEPS:s.x0,currentRenderedComponent:i,steps:x,currentStep:c,error:d,transferData:v,currentStepConfig:h,proceedToNextStep:f,editTransfer:p}}}),H=(0,T.A)(X,[["render",a]]),Q=H}}]);